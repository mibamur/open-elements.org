  <dom-module id="edit-in-jsbin">
    <template>
      <iron-ajax auto
 url="{{url}}"
        handle-as="text"
        last-response="{{got}}"></iron-ajax>
      
      <form target="newbin" action="http://jsbin.com/" method="post">
        <input type="hidden" name="html" value="{{html}}" />
        <input type="image" alt="Edit in JSbin" src="/images/jsbin.svg" />
      </form>
    </template>
  </dom-module>
<script>
  (function () {
    Polymer({
      is: 'edit-in-jsbin',
      properties: {
        html:{ 
            computed:"getHtml(got,url)"
        },
        css:{ 
            computed:"getCss(got)"
        },
        url:String
      },
      getHtml: function(got,url) {
        base = '<base href="' + url.match(/(.*)\//)[0] + '">';     
        return got.replace('<head>','<head>'+ base);
      },
      getCss: function(got) {
        style = got.match(/<style>(.*?)<\/style>/g)
        return style.replace(['<style>','</style>'],'');
      }
    });
  })();
</script>
